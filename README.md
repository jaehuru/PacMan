# PacMan Clone – 2D Game Project

# Project Description

[자체 제작한 Win32 기반 2D 게임 엔진](https://github.com/jaehuru/JaehuruEngine)을 활용하여 클래식 게임 **팩맨(Pac-Man)** 을 구현합니다.  
게임 구조 설계, AI 상태머신 구현, 타일 기반 맵 로직, 간단한 UI 시스템을 통합하는 것을 목표로 합니다.

## Development Environment
- 'Window OS'
- 'Visual Studio 2022'

---

## Game Design

### 타일맵 시스템
- 고정된 타일 기반 맵 사용 (벽, 길, 점, 출구 구분)
- 충돌 처리는 **벽 기준**으로만 수행
- 타일 단위 이동이므로 FSM 기반 AI 설계가 용이

### 플레이어 컨트롤
- 방향키 입력에 따라 진행 방향 결정
- 방향 전환 시, 다음 타일의 유효성 검사 후 이동 결정
- Dot 수집 시 점수 증가

### 유령 AI (FSM 기반)
- 유령은 다음과 같은 상태를 가짐:
  - `대기`: 일정 시간 정지
  - `추격`: 플레이어 방향 추적
  - `공격`: 근접 시 플레이어 제거 시도
  - `죽음`: 사망 후 부활 대기
- 간단한 방향 추적 or A* 알고리즘 가능

### UI 시스템
- 점수 표시 텍스트
- 게임 오버 화면 및 텍스트
- (선택) 재시작 버튼 또는 키 입력 처리

### 게임 조건 처리
- Dot을 모두 먹으면 클리어
- 유령에게 잡히면 사망 → 게임 오버

---

# Implementation Overview

### 싱글톤 패턴

`GameManager` 클래스를 통한 싱글톤 패턴 적용으로  
리소스 관리, 씬 전환, 맵 로드 등을 편리하게 처리

### ToolScene 클래스

- SpriteSheet를 활용해 타일 생성, 삭제, 타일 타입 선택, 타일 맵 파일 저장/불러오기 기능을 구현
- 카메라 스크립트 객체를 생성하여 카메라를 이동할 수 있고 마우스 클릭과 키보드 입력을 통해 맵을 편리하게 편집 가능

### Tile 클래스 (GameObject 기반)

- 타일 하나를 객체 단위로 관리
- 인덱스 변수를 통한 위치 정보를 별도로 보유해 맵 데이터와 연동
- 초기화 시 `TileMapRenderer` 컴포넌트를 가져와 타일 크기 및 스케일을 설정해 렌더링 준비

### PlayerScript 클래스

- 레이어의 **타일 기반 이동 로직** 및 **이동 가능 여부 판단** 구현
- 타일 중심 스냅 로직을 활용하여 정교한 위치 보정 처리
- 타일맵의 정보와 충돌 검사를 통해 유효한 이동만 허용
- **방향에 따라 실시간으로 애니메이션 전환** 구현 (Animator 연동)
- 포탈 이동 시스템 구현 (포탈 타일 도달 시 다른 포탈로 순간이동)

---

# Bug Issue

## 터널링 (Tunnelling) 현상

**터널링 현상**이란, 충돌 처리가 필요한 게임 오브젝트가 다른 충돌체를 관통하여 지나가는 현상입니다.

### 발생 원인

- GDI+ 렌더링 성능 한계로 인해 프레임 처리 속도가 저하되면서 `deltaTime` 값이 증가.
- SnapToTileCenter 기반의 이동 로직에서 한 프레임 동안 이동 거리가 커져버리면서 타일 기반 충돌을 통과하는 문제가 발생.

### 해결 방법

- 현재 타일 중심 좌표와 예상 이동 위치 (`nextPos`) 간의 거리를 계산.
- 이번 프레임 이동 거리보다 중심과의 거리가 더 작을 경우, 중심을 지나칠 위험이 있다고 판단.
- 해당 경우, **타일 중심 좌표로 스냅(Snap)** 하여 위치를 보정함으로써 벽 통과를 방지.

### 부작용 및 한계

- 이동 중 특정 구간에서 순간적으로 이동 속도가 감소하거나 멈칫하는 듯한 느낌이 발생.
- 완전히 부드럽지는 않지만, 단순한 타일 기반 게임에서는 충분히 실용적인 해결책으로 채택.
